<!DOCTYPE HTML>
<html>
<head>
<title>CyberAbyss Text Reader v1.0</title>
 
<HTA:APPLICATION
  APPLICATIONNAME="My First HTML Application"
  ID="MyFirstHTA"
  VERSION="1.0"
  SCROLL="no"/>
 
<style type="text/css">
body {
	background-color: #fdfeff;
	color: darkblue;
	font-family: Calibri;
	font-size: 12pt;
	margin: 4em 3em;
}
</style>
</head>
 
<script language="VBScript">
'Important note: The Sapi control panel opens here using the .cpl file.
'Set your system's voice setting here and the you will have to play around with the numbers to find the right voice.
'C:\Windows\SysWOW64\Speech\SpeechUX\sapi.cpl
Option Explicit


Sub TextToSpeechToFile(strText) 
	Const SAFT48kHz16BitStereo = 39
	Const SSFMCreateForWrite = 3 ' Creates file even if file exists and so destroys or overwrites the existing file

	Dim oFileStream, oVoice, voice_number

	Set oFileStream = CreateObject("SAPI.SpFileStream")
	
	oFileStream.Format.Type = SAFT48kHz16BitStereo
	oFileStream.Open "Sample.wav", SSFMCreateForWrite

	Set oVoice = CreateObject("SAPI.SpVoice")
	voice_number = document.getElementById("voice_number").value
	Set oVoice.Voice = oVoice.GetVoices.Item(voice_number)
	Set oVoice.AudioOutputStream = oFileStream
	oVoice.Speak strText

	oFileStream.Close
End Sub
 
Sub Window_OnLoad
	window.resizeTo 1200, 800
	document.title = document.title & ",  Version " & MyFirstHTA.Version
End Sub

Sub TextToSpeech()
	Dim speachInput, voice_number
	Dim sapi
	voice_number = document.getElementById("voice_number").value
	speachInput = document.getElementById("TextToRead").value
	
	Set sapi = createObject("sapi.spvoice")
	Set sapi.Voice = sapi.GetVoices.Item(voice_number)
	
	sapi.Speak speachInput
	TextToSpeechToFile speachInput
End Sub
</script>
 
<body>
<h1>CyberAbyss Text Reader v1.0 Beta</h1> 

Voice Number: 0 thru X
<input type="text" id="voice_number" value="0" />
<input type="button" value="Read Text" onclick="TextToSpeech" /></p> 
<textarea id="TextToRead" name="TextToRead" rows="12" cols="80">
</textarea> 
<p id="OutputResult">Paste text you want to read and click "Read Text".</p> 
</body>
</html>
