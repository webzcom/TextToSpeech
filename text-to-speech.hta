<!DOCTYPE HTML>
<html>
<head>
<title>CyberAbyss Text Reader v1.0</title>
 
<HTA:APPLICATION
  APPLICATIONNAME="CyberAbyss Text Reader 1.0"
  ID="CyberAbyssTextReader"
  VERSION="1.0"
  SCROLL="no"/>
 
<style type="text/css">
body {
	background-color: #fdfeff;
	color: darkblue;
	font-family: Calibri;
	font-size: 12pt;
	margin: 1em 1em;
}
</style>
</head>
 
<script language="VBScript">
'Important note: The Sapi control panel opens here using the .cpl file.
'Set your system's voice setting here and the you will have to play around with the numbers to find the right voice.
'C:\Windows\SysWOW64\Speech\SpeechUX\sapi.cpl
Option Explicit

ON ERROR RESUME NEXT
Sub TextToSpeechToFile(strText) 
	Const SAFT48kHz16BitStereo = 39
	Const SSFMCreateForWrite = 3 ' Creates file even if file exists and so destroys or overwrites the existing file

	Dim oFileStream, oVoice, voice_number, strFileOut

	Set oFileStream = CreateObject("SAPI.SpFileStream")
		
	strFileOut = document.getElementById("FileOut").value 
	if LCase(Right(strFileOut,4)) <> ".wav" then
		strFileOut = strFileOut & ".wav"
	end if
	
	oFileStream.Format.Type = SAFT48kHz16BitStereo
	oFileStream.Open strFileOut, SSFMCreateForWrite

	Set oVoice = CreateObject("SAPI.SpVoice")
	voice_number = document.getElementById("voice_number").value
	Set oVoice.Voice = oVoice.GetVoices.Item(voice_number)
	Set oVoice.AudioOutputStream = oFileStream
	oVoice.Speak strText

	oFileStream.Close
End Sub
 
Sub Window_OnLoad
	window.resizeTo 1300, 1000
	'document.title = document.title & ",  Version " & MyFirstHTA.Version
	ListVoices
End Sub

Sub TextToSpeech()
	Dim speachInput, voice_number
	Dim sapi
	voice_number = document.getElementById("voice_number").value
	speachInput = document.getElementById("TextToRead").value
	
	Set sapi = createObject("sapi.spvoice")
	Set sapi.Voice = sapi.GetVoices.Item(voice_number)
	sapi.Rate = document.getElementById("rate").value 
	sapi.Volume = 90
	
	
	If CreateFileOnlyCheck then
		TextToSpeechToFile speachInput
	else
		sapi.Speak speachInput
		TextToSpeechToFile speachInput
	end if
End Sub

Sub ListVoices()
	Dim objVoice, strVoice, strVoiceList
	Set objVoice  = createObject("sapi.spvoice")
	
	strVoiceList = "Installed voices: "
	
'List voices that are installed.
For Each strVoice in objVoice.GetVoices
    strVoiceList = strVoiceList & " | " & strVoice.GetDescription
Next
document.getElementById("VoiceList").value = strVoiceList
End Sub

function CreateFileOnlyCheck() 
    if document.getElementById("createFileOnly").checked then
		msgbox("Create MP3 file only.")
		CreateFileOnlyCheck = true
	end if
end function	
}
</script>
 
<body>
<h1>CyberAbyss Text Reader v1.0 Beta</h1> 

Voice Number: 0 thru X
<br>
<input type="text" id="voice_number" value="0" /><br>
Reading Rate<br>
<input type="text" id="rate" value="1" /><br>
Reading Rate<br>
<input size="55" type="text" id="FileOut" value="Sample" />.wav 
<input type="checkbox" id="createFileOnly" name="createFileOnly" value="Yes">
  <label for="createFileOny"> Create MP3 file only</label><br>
<input type="button" value="Read Text" onclick="TextToSpeech" /></p>

 
<textarea id="TextToRead" name="TextToRead" rows="20" cols="90">
</textarea> 
<textarea id="VoiceList" name="VoiceList" rows="4" cols="80">
</textarea>
<p id="OutputResult">Paste text you want to read and click "Read Text".</p> 
</body>
</html>
